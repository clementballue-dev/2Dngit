<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Shooter</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    overflow: hidden;
    background: #4da6ff;
  }

  #playBtn {
    position: fixed;
    bottom: 20px;
    right: 20px;
    padding: 15px 25px;
    font-size: 18px;
    border: none;
    border-radius: 8px;
    background: black;
    color: white;
    cursor: pointer;
  }
</style>
</head>
<body>

<canvas id="game"></canvas>
<button id="playBtn">JOUER</button>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = innerWidth;
canvas.height = innerHeight;

window.addEventListener("resize", () => {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
});

// ================= CLAVIER =================
const keys = {};
window.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
window.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

// ================= ETAT =================
let playing = false;
let ammo = 10;
let bullets = [];

// ================= JOUEUR =================
const player = {
  x: canvas.width / 2,
  y: canvas.height / 2,
  size: 40,
  speed: 5
};

// ================= ENNEMI =================
const enemy = {
  x: 200,
  y: 200,
  size: 40,
  life: 3
};

// ================= DEPLACEMENT =================
function movePlayer(){
  if(keys["z"]) player.y -= player.speed;
  if(keys["s"]) player.y += player.speed;
  if(keys["q"]) player.x -= player.speed;
  if(keys["d"]) player.x += player.speed;
}

// ================= TIR =================
window.addEventListener("click", () => {
  if(!playing) return;

  if(ammo > 0){
    bullets.push({
      x: player.x + player.size,
      y: player.y + player.size / 2,
      speed: 10
    });
    ammo--;
  } else {
    ammo = 10; // recharge
  }
});

// ================= COLLISION =================
function hitEnemy(b){
  return (
    b.x > enemy.x &&
    b.x < enemy.x + enemy.size &&
    b.y > enemy.y &&
    b.y < enemy.y + enemy.size
  );
}

// ================= DESSIN =================
function drawPlayer(){
  // corps
  ctx.fillStyle = "#222";
  ctx.fillRect(player.x, player.y, player.size, player.size);

  // pistolet
  ctx.fillStyle = "#555";
  ctx.fillRect(
    player.x + player.size,
    player.y + player.size/2 - 5,
    25,
    10
  );
}

function drawEnemy(){
  if(enemy.life > 0){
    ctx.fillStyle = "red";
    ctx.fillRect(enemy.x, enemy.y, enemy.size, enemy.size);
  }
}

function drawBullets(){
  ctx.fillStyle = "yellow";
  bullets.forEach((b, i) => {
    b.x += b.speed;
    ctx.fillRect(b.x, b.y, 8, 4);

    // collision ennemi
    if(enemy.life > 0 && hitEnemy(b)){
      enemy.life--;
      bullets.splice(i, 1);
    }

    // hors Ã©cran
    if(b.x > canvas.width){
      bullets.splice(i, 1);
    }
  });
}

// ================= LOOP =================
function loop(){
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  if(playing){
    movePlayer();
    drawPlayer();
    drawEnemy();
    drawBullets();
  }

  requestAnimationFrame(loop);
}
loop();

// ================= JOUER =================
document.getElementById("playBtn").onclick = () => {
  playing = true;
  document.getElementById("playBtn").style.display = "none";
};
</script>

</body>
</html>

